<!doctype html>
<html lang="en">
<head> 
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Referral Form â€” Meadow Pathways</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="blugoon-body">

  <!-- Page Header -->
  <section class="page-header">
    <h1>Referral Form â€” Meadow Pathways</h1>
    <h2>Submit referrals for children and young people with care and clarity ğŸŒ¿âœ¨</h2>
  </section>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-inner">
      <div class="logo-wrap">
        <a href="index.html"><img src="Logo.png" alt="Meadow Pathways logo" class="sidebar-logo"></a>
      </div>
      <nav class="side-nav" aria-label="Primary site navigation">
        <ul class="nav-tabs" role="menubar">
          <li><a href="index.html" class="nav-tab home">ğŸ  Home</a></li>
          <li><a href="eotas.html" class="nav-tab eotas">ğŸ” EOTAS</a></li>
          <li><a href="about.html" class="nav-tab about">â„¹ï¸ About Us</a></li>
          <li><a href="policies.html" class="nav-tab policies">ğŸ“˜ Policies</a></li>
          <li><a href="referral.html" class="nav-tab referral" aria-current="page">ğŸ“ Referral</a></li>
          <li><a href="contact.html" class="nav-tab contact">â˜ï¸ Contact</a></li>
          <li><a href="staff.html" class="nav-tab staff">ğŸ‘©â€ğŸ« Staff Only</a></li>
          <li><a href="treverno.html" class="nav-tab treverno">ğŸ¡ Treverno Meadows</a></li>
          <li><a href="safeguarding.html" class="nav-tab safeguarding">ğŸ›¡ Safeguarding</a></li>
        </ul>
      </nav>
    </div>
  </aside>

  <!-- Main content -->
  <main class="main-content">
    <section class="wrap card">
      <h1>Referral Form ğŸ“</h1>
      <p>Please complete the form below for a referral to Meadow Pathways. This form can be submitted by local authorities or parent/carers. All information is treated confidentially.</p>

      <!-- Formspree form -->
      <form id="referralForm" action="https://formspree.io/f/movnvzqp" method="POST" class="styled-form">
        
        <!-- Child/Young Person Details -->
        <h2>Child/Young Person Details</h2>
        <label>Full Name<br><input type="text" name="child_name" required></label>
        <label>Date of Birth<br><input type="date" name="dob" required></label>
        <label>Address<br><input type="text" name="address" required></label>
        <label>Current School<br><input type="text" name="current_school"></label>
        <label>EHCP Status<br>
          <select name="ehcp_status">
            <option value="none">None</option>
            <option value="in_progress">In Progress</option>
            <option value="active">Active</option>
          </select>
        </label>

        <!-- Referral Details -->
        <h2>Referral Information</h2>
        <label>Reason for Referral<br><textarea name="referral_reason" rows="4" required></textarea></label>
        <label>Current Challenges / Needs<br><textarea name="current_needs" rows="4"></textarea></label>
        <label>Desired Outcomes<br><textarea name="desired_outcomes" rows="4"></textarea></label>

        <!-- Referrer Details -->
        <h2>Referrer Details</h2>
        <label>Name<br><input type="text" name="referrer_name" required></label>
        <label>Role / Relationship<br><input type="text" name="referrer_role" required></label>
        <label>Email<br><input type="email" name="referrer_email" required></label>
        <label>Phone<br><input type="tel" name="referrer_phone"></label>

        <div class="form-buttons">
          <button type="submit" class="submit-btn">Submit Referral</button>
          <button type="button" id="downloadBtn" class="download-btn">Download Copy</button>
        </div>
      </form>

      <p class="note">For urgent cases or safeguarding concerns, please contact statutory services: â˜ï¸ 01872 324605, or email earlyhelphub@cornwall.gov.uk, then contact the Meadow Pathways team directly.</p>
    </section>

    <!-- Footer -->
    <footer class="footer" style="background-image: url('BG.png'); background-size: cover; background-position: center; padding: 20px; color: #ffffff; text-align: center; font-size: 1rem;">
      <p>Meadow Pathways Wellbeing & Education Cornwall Ltd Â© 2025</p>
      <p>Michelle: 07932 243358 | Zoe: 07775 733587</p>
      <p>If your enquiry is urgent or a safeguarding concern, please contact statutory services: â˜ï¸ 01872 324605 - earlyhelphub@cornwall.gov.uk</p>
    </footer>
  </main>

  <!-- JS: download and clear form -->
  <script>
    const form = document.getElementById('referralForm');
    const downloadBtn = document.getElementById('downloadBtn');

    downloadBtn.addEventListener('click', () => {
      const data = new FormData(form);
      let text = "Referral Form â€” Meadow Pathways\n\n";
      for (const [key, value] of data.entries()) {
        const label = key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        text += `${label}: ${value}\n`;
      }
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'MeadowPathways_Referral.txt';
      a.click();
      URL.revokeObjectURL(url);
    });

    // Handle submission with feedback
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      try {
        const response = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: { 'Accept': 'application/json' }
        });
        if (response.ok) {
          alert('âœ… Thank you â€” your referral has been securely submitted.');
          form.reset();
        } else {
          alert('âš ï¸ There was a problem submitting the form. Please try again.');
        }
      } catch (error) {
        alert('âš ï¸ Network error â€” please check your connection and try again.');
      }
    });
  </script>

</body>
</html>
